# TCP 粘包问题

TCP 粘包原因如下：

- TCP 面向字节流传输，流水很难界定边界
- TCP 在发送数据包时，会通过使用缓冲区来进行优化
  - 如果发送的数据比较小，且对方应答报文 `SYN` 没有发送过来，且开启了
  - 如果发送的数据大于缓冲区大小，那么数据将拆开为多个报文

解决办法：

- 通信双方协商一个包传输的大小，只传输固定长度的消息
- 特殊字符作为边界，比如 HTTP 中的 `\r\n`
- 将消息分为消息头或者消息体
  - 也就是每个包的开头加点信息，说明传输数据的大小

比如使用 `System.IO.Pipeline` ，可以找规定结束符号的地方，将消息分割为多个包。
