# 内存对齐

> 结构体一个int一个char占多大空间

答案是，看情况。

```c++
struct Foo {
    int a;
    char b;
};
// sizeof(Foo) == 8
```

对于现代计算机来说，都是按照 byte 作为内存单位的，虽然数据可以按照想要的格式存储在内存中，但是实际上按照正常的来说，需要其**首地址是 4 或 8 的倍数（看架构）**。

## 为什么需要内存对齐

虽然内存基本是按照字节作为单位的，但是实际上处理器并不是按照一个一个字节读的，而是多个字节一块读取，如果数据没有对齐，那么处理器读取的时候就得对读取的内存块进行筛选，提取出其中的数据，这很麻烦。特别的，一般 cpu 还是支持给你做这样麻烦的工作，但是并不是所有 cpu 都会，可能存在一些 cpu ，会直接 cpu 异常，或者直接崩溃。

## 内存对齐的规则

看 `#pragma pack(n)` 中，n 与结构体内最长数据类型长度中最大的那个比。

> n 是 2 的次幂
